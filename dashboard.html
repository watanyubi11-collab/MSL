<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Dashboard à¸„à¸£à¸¹</title>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <style>
    body {font-family:'Kanit',sans-serif;background:#f9f6ff;margin:0;padding:0;}
    .container {max-width:1100px;margin:auto;padding:20px;}
    h1 {text-align:center;color:#7c4dff;margin-bottom:30px;}
    h2 {color:#5e35b1;margin-top:40px;}
    table {width:100%;border-collapse:collapse;margin:20px 0;border-radius:12px;overflow:hidden;}
    th,td {border:1px solid #ddd;padding:12px;text-align:center;}
    th {background:#7c4dff;color:#fff;}
    tr:nth-child(even) {background:#f3e8ff;}
    canvas {max-width:100%;margin-top:20px;}
    @media(max-width:700px){
      table,thead,tbody,tr,td,th{display:block;width:100%;}
      td{border:none;border-bottom:1px solid #ddd;position:relative;padding-left:50%;}
      td:before{position:absolute;top:10px;left:10px;width:45%;white-space:nowrap;font-weight:bold;}
      td:nth-of-type(1):before{content:"à¸„à¸£à¸¹/à¸§à¸´à¸Šà¸²";}
      td:nth-of-type(2):before{content:"à¸„à¹ˆà¸²à¹€à¸‰à¸¥à¸µà¹ˆà¸¢";}
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>ðŸ“Š Dashboard à¸„à¸£à¸¹</h1>

    <h2>à¸„à¸£à¸¹à¸œà¸¹à¹‰à¸ªà¸­à¸™à¸§à¸´à¸Šà¸²</h2>
    <table id="subject_table">
      <thead><tr><th>à¸„à¸£à¸¹ + à¸§à¸´à¸Šà¸²</th><th>à¸„à¹ˆà¸²à¹€à¸‰à¸¥à¸µà¹ˆà¸¢</th></tr></thead><tbody></tbody>
    </table>
    <canvas id="subjectChart"></canvas>

    <h2>à¸„à¸£à¸¹à¸›à¸£à¸°à¸ˆà¸³à¸Šà¸±à¹‰à¸™</h2>
    <table id="homeroom_table">
      <thead><tr><th>à¸„à¸£à¸¹à¸›à¸£à¸°à¸ˆà¸³à¸Šà¸±à¹‰à¸™</th><th>à¸„à¹ˆà¸²à¹€à¸‰à¸¥à¸µà¹ˆà¸¢</th></tr></thead><tbody></tbody>
    </table>
    <canvas id="homeroomChart"></canvas>
  </div>

  <script>
    const WEB_APP_URL = "PASTE_YOUR_DEPLOYED_WEBAPP_URL_HERE?mode=summary";

    async function loadData(){
      const res = await fetch(WEB_APP_URL);
      const json = await res.json();

      // Subjects
      let stBody=document.querySelector("#subject_table tbody");
      stBody.innerHTML="";
      let subLabels=[],subData=[];
      json.subjects.forEach(s=>{
        stBody.innerHTML += `<tr><td>${s.teacher_subject}</td><td>${s.avg}</td></tr>`;
        subLabels.push(s.teacher_subject);subData.push(s.avg);
      });
      new Chart(document.getElementById("subjectChart"),{
        type:"bar",
        data:{labels:subLabels,datasets:[{label:"à¸„à¹ˆà¸²à¹€à¸‰à¸¥à¸µà¹ˆà¸¢",data:subData,backgroundColor:"#7c4dff"}]},
        options:{responsive:true,plugins:{legend:{display:false}}}
      });

      // Homerooms
      let hrBody=document.querySelector("#homeroom_table tbody");
      hrBody.innerHTML="";
      let hrLabels=[],hrData=[];
      json.homerooms.forEach(h=>{
        hrBody.innerHTML += `<tr><td>${h.homeroom}</td><td>${h.avg}</td></tr>`;
        hrLabels.push(h.homeroom);hrData.push(h.avg);
      });
      new Chart(document.getElementById("homeroomChart"),{
        type:"bar",
        data:{labels:hrLabels,datasets:[{label:"à¸„à¹ˆà¸²à¹€à¸‰à¸¥à¸µà¹ˆà¸¢",data:hrData,backgroundColor:"#ff8a65"}]},
        options:{responsive:true,plugins:{legend:{display:false}}}
      });
    }
    loadData();
  </script>
</body>
</html>
